# Package manager
if [[ "$OS" == "ubuntu" ]]; then
    # Remove apt packages
    function apt_completely_remove_package() {
        sudo apt-get remove --auto-remove --purge $1
        sudo apt-get clean
        sudo apt-get autoremove -y
    }
    alias crm="apt_completely_remove_package"
else
    # Remove brew packages
    function brew_completely_remove_package() {
        brew uninstall --force $1
        brew cleanup
    }
fi

# Tmux new-session
function tmux_new_session() {
    tmux new-session -d -s "$1"
}

# Yazi
function yz() {
    local tmp="$(mktemp -t "yazi-cwd.XXXXXX")" cwd
    yazi "$@" --cwd-file="$tmp"
    if cwd="$(command cat -- "$tmp")" && [ -n "$cwd" ] && [ "$cwd" != "$PWD" ]; then
        builtin cd -- "$cwd"
    fi
    rm -f -- "$tmp"
}

# Python environment
function create_virtual_python_environment() {
    local python_version=3.12
    if [[ "$1" == "uv" ]]; then
        echo "Virtual environment using uv."
        uv init -p ${python_version}
        uv venv -p ${python_version}
        uv sync
        uv add pip
        source .venv/bin/activate
        pip install --upgrade pip
    else 
        echo "Virtual environment using venv."
        python${python_version} -m venv .venv
        source .venv/bin/activate
        pip install --upgrade pip
    fi
}

# dbt
# Always update this env
# python -m pip install --upgrade pip wheel setuptools
alias dbtenv='source ${HOME}/.dbt-env/bin/activate'

# Find something
function global_find() {
    fd $1 /
}

# Common
alias c="clear"

# Useful custom
if [[ "$OS" == "ubuntu" ]]; then
    alias crm="apt_completely_remove_package"
else
    alias crm="brew_completely_remove_package"
fi
alias gfind="global_find"

# Python
alias cpv=create_virtual_python_environment
alias apv='source ./.venv/bin/activate'
alias dpv='deactivate'

# Tmux
alias tns="tmux_new_session"

# Apps
alias nv='nvim'
alias dc='docker compose'
alias lzd='lazydocker'
alias lzg='lazygit'
if [[ "$OS" == "ubuntu" ]]; then
    alias bcat='batcat'
    alias fd='fdfind'
else
    alias bcat='bat'
fi
alias cd='z'
alias code='cursor'

# Docker
alias dkc-stop='docker stop $(docker ps -aq)'
alias dkc-rm='docker rm $(docker ps -aq)'
alias dkv-prune='docker volume prune -f'

# Kubernetes
source <(kubectl completion zsh)
alias kbc='kubectl'
alias kbc-c='kubectl-convert'
alias kind='kind'
alias mkb='minikube'
complete -o default -F __start_kubectl kbc
complete -o default -F __start_kubectl kbc-c
complete -o default -F __start_kubectl kubectl
complete -o default -F __start_kubectl kind
complete -o default -F __start_kubectl mkb

# OpenVPN
alias ovpn-start='sudo openvpn --config  --auth-user-pass ~/openvpn/credentials.txt'

alias dt='cd "$HOME/Desktop" && echo "$HOME/Desktop"'
alias dl='cd "$HOME/Downloads" && echo "$HOME/Downloads"'
alias dc='cd "$HOME/Documents" && echo "$HOME/Documents"'

# Change directory aliases
# ** COMP **
# if [[ "$PC_TYPE" == "WORK" ]]; then
#     alias cdpj='cd "$HOME/workspace/414n/projects" && echo "$HOME/workspace/414n/projects"'
#     alias cdrs='cd "$HOME/workspace/414n/research" && echo "$HOME/workspace/414n/research"'
# else
#     alias cdcode='cd "$HOME/qn/area/coding" && echo "$HOME/qn/area/coding"'
#     alias cdwork='cd "$HOME/qn/area/work" && echo "$HOME/qn/area/work"'
# fi
